$("div#layout").use($u).addState("root",null,uTplPath+"/layout/default.html",null).replace(),$("ul#header-menu").use($u).setParent("root").addState("header-menu",null,"layout/menu/header",null).converter(function(e){e.menuElements=[{title:"Home",hash:"/home"},{title:"About",hash:"/about"},{title:"Sign In",hash:"/sign-in"}]}).replace(),$("div#content").use($u).setParent("root").addState("home","/home","home/index",null).loadBefore(["unlogged-header-menu"]).replace(),$("div#content").use($u).setParent("root").addState("about","/about","test/index",null).loadBefore(["unlogged-header-menu"]).replace(),$("div#content").use($u).setParent("root").addState("signIn","/sign-in","user/signin",null).loadBefore(["unlogged-header-menu"]).addListener("jquery",["form#userPost","submit"],function(e){e.preventDefault();var t=a.form.get($(this).get(0));$ws.post("users/signin",{data:t},function(e){"success"==e.type&&(a.storage.setItem("auth",e.data),window.location.hash="#/app/dashboard")})}).replace(),$("div#content").use($u).setParent("root").addState("signUp","/sign-up","user/signup",null).loadBefore(["unlogged-header-menu"]).addListener("jquery",["form#userPost","submit"],function(e){e.preventDefault();var t=a.form.get(e.target);$ws.post("users/signup",{data:t},function(e){"success"==e.type&&(window.location.hash="#/sign-in")})}).replace(),$("div#layout").use($e).addState("root",null,uTplPath+"/layout/default.html",null).replace(),$("div#content").use($e).setParent("root").addState("404","/error/404","404",null).replace(),$("div#layout").use($l).addState("root",null,lTplPath+"/layout/default.html",null).postLoad(function(){a.timer.add(function(){var e=a.storage.getItem("auth");$ws.post("users/signin",{data:e},function(e){"error"==e.type&&(a.storage.removeItem("auth"),window.location.hash="#/home")})},this,24e4)}).replace(),$("ul#header-menu").use($l).setParent("root").addState("header-menu",null,"layout/menu/header",null).converter(function(e){e.menuElements=[{title:"Dashboard",hash:"/app/dashboard"},{title:"Mes Markers",hash:"/app/markers"},{title:"Mon profil",hash:"/app/profile"}]}).replace(),$("div#content").use($l).setParent("root").addState("dashboard","/app/dashboard","/dashboard/index",{products:$ws.use("getHost",["products/list"])}).converter(function(e){var t=$ws.use("getHost",[""]);for(e.markers=[],i=e.products.length;i--;){var a={id:e.products[i].id,title:e.products[i].title,description:e.products[i].description,lat:e.products[i].lat,lgt:e.products[i].lgt,ico_url:t+"uploads/markers/"+e.products[i].products_meta_id+".png"};e.markers.push(a)}}).postLoad(function(e){var t=e.getFullData();new MapHelper({zoom:4},document.getElementById("map_canvas"),t.markers,function(e,t,a){var o='<div id="content"><div id="siteNotice"></div><h1 id="firstHeading" class="firstHeading">'+a.title+"</h1>"+'<div id="bodyContent">'+"<p>"+a.description+"</p>"+"</div>"+"</div>",r=new google.maps.InfoWindow({content:o,maxWidth:400});google.maps.event.addListener(t,"click",function(){r.open(e,t)})})}).addFile("js",["resources/js/helpers/MapHelper.js"]).loadBefore(["logged-header-menu"]).replace(),$("div#content").use($l).setParent("root").addState("markers-root","/app/markers","products/index").postLoad(function(){$("#myTab a").click(function(e){e.preventDefault(),$(this).tab("show")}),$("#myTab a:first").tab("show")}).loadBefore(["logged-header-menu"]).loadAfter(["logged-markers-list","logged-categories-list","logged-metas-list"]).replace(),$("div#markers").use($l).setParent("markers-root").addState("markers-list","/app/markers","products/list",{markerList:$ws.use("getHost",["products/list"]),categoryList:$ws.use("getHost",["products/categories/list"]),metaList:$ws.use("getHost",["products/metas/list"])}).converter(function(e){console.log(e.product);var t=function(e,t){return a.isNull(e)?void 0:e.length<t?e:e.substring(0,t)+"..."},o=function(e,t){for(var a in e){var o=e[a];if(o.id==t)return o}return null};e.list=[];for(var r in e.markerList){var s=e.markerList[r];e.list.push({id:s.id,title:s.title,description:s.description,categoryName:o(e.categoryList,s.products_category_id).name,metaName:o(e.metaList,s.products_meta_id).icon})}for(var r in e.metaList)e.metaList[r].icon=t(e.metaList[r].icon,20);for(var r in e.categoryList)e.metaList[r].name=t(e.metaList[r].name,20)}).postLoad(function(){$("#category").ddslick({selectText:"Get a category",truncate:!0,width:"100%",onSelected:function(e){var t=e.selectedData.value;$('input[name="products_category_id"]').val(t)}}),$("#meta").ddslick({selectText:"Get a meta",truncate:!0,width:"100%",onSelected:function(e){var t=e.selectedData.value;$('input[name="products_meta_id"]').val(t)}})}).addListener("jquery",["a#map","click"],function(e){e.preventDefault(),$(this).popover(),$(this).on("shown.bs.popover",function(){$(this).next(".popover").find(".popover-content").html('<div id="map_canvas"></div>'),new MapHelper({draggable:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.BIG},scaleControl:!0,scaleControlOptions:{style:google.maps.ScaleControlStyle.DEFAULT}},document.getElementById("map_canvas"),{title:"La position de mon produit",lgt:$("form#productPost input#lgt").val()||0,lat:$("form#productPost input#lat").val()||0},function(e,t){google.maps.event.addListener(t,"click",function(){infowindow.open(e,t)}),google.maps.event.addListener(t,"drag",function(){$("#lat").val(t.position.lat()),$("#lgt").val(t.position.lng())})}),$("#map_canvas").css({width:"100%",height:"400px"})})}).addListener("jquery",["form#productPost","submit"],function(e){e.preventDefault();var t=a.form.get(e.target);$ws.post("products",{data:t},function(){window.location.href="#/app/dashboard"})}).addListener("jquery",["a#productDelete","click"],function(e){e.preventDefault();var t=$(this).attr("data-id");$ws.delete("products/"+t,null,function(){a.state.forceReloadById("logged-markers-list")})}).addFile("js",["resources/js/helpers/MapHelper.js","vendors/jquery.ddslick.min.js"]).replace(),$("div#categories").use($l).setParent("markers-root").addState("categories-list",null,"products/categories/list",{categoryList:$ws.use("getHost",["products/categories/list"])}).addListener("jquery",["form#categoryPost","submit"],function(e){e.preventDefault();var t=a.form.get(e.target);$ws.post("products/categories",{data:t},function(){window.location.href="#/app/dashboard"})}).addListener("jquery",["a#categoryDelete","click"],function(e){e.preventDefault();var t=$(this).attr("data-id");$ws.delete("products/category/"+t,null,function(){a.state.forceReloadById("logged-categories-list")})}).replace(),$("div#metas").use($l).setParent("markers-root").addState("metas-list",null,"products/metas/list",{metaList:$ws.use("getHost",["products/metas/list"])}).addListener("jquery",["form#metaPost","submit"],function(e){e.preventDefault();var t=new FormData(e.target);$ws.file("post","products/metas",t,function(){a.state.forceReloadById("logged-metas-list")},null,xhr)}).replace(),$("div#content").use($l).setParent("root").addState("dashboard","/app/profile","/profile/index",null).loadBefore(["logged-header-menu"]).replace();